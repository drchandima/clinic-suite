{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///D:/Education/WebDev%20with%20AI/Projects/clinic-suite/utils/idHelpers.js"],"sourcesContent":["// utils/idHelpers.js\nexport function formatDateToId(date = new Date()){\n  const d = (date instanceof Date) ? date : new Date(date);\n  const pad = (n) => String(n).padStart(2, '0');\n  const YYYY = d.getFullYear();\n  const MM = pad(d.getMonth() + 1);\n  const DD = pad(d.getDate());\n  const hh = pad(d.getHours());\n  const mm = pad(d.getMinutes());\n  const ss = pad(d.getSeconds());\n  return `${YYYY}${MM}${DD}${hh}${mm}${ss}`;\n}\n"],"names":[],"mappings":"AAAA,qBAAqB;;;;;AACd,SAAS,eAAe,OAAO,IAAI,MAAM;IAC9C,MAAM,IAAI,AAAC,gBAAgB,OAAQ,OAAO,IAAI,KAAK;IACnD,MAAM,MAAM,CAAC,IAAM,OAAO,GAAG,QAAQ,CAAC,GAAG;IACzC,MAAM,OAAO,EAAE,WAAW;IAC1B,MAAM,KAAK,IAAI,EAAE,QAAQ,KAAK;IAC9B,MAAM,KAAK,IAAI,EAAE,OAAO;IACxB,MAAM,KAAK,IAAI,EAAE,QAAQ;IACzB,MAAM,KAAK,IAAI,EAAE,UAAU;IAC3B,MAAM,KAAK,IAAI,EAAE,UAAU;IAC3B,OAAO,GAAG,OAAO,KAAK,KAAK,KAAK,KAAK,IAAI;AAC3C"}},
    {"offset": {"line": 27, "column": 0}, "map": {"version":3,"sources":["file:///D:/Education/WebDev%20with%20AI/Projects/clinic-suite/lib/firestoreClient.js"],"sourcesContent":["// lib/firestoreClient.js\r\n// Consolidated Firestore client helpers for Clinic Suite\r\nimport { db } from './firebase';\r\nimport {\r\n  collection,\r\n  doc,\r\n  setDoc,\r\n  getDocs,\r\n  query,\r\n  orderBy,\r\n  onSnapshot,\r\n  where,\r\n  updateDoc,\r\n  deleteDoc,\r\n  getDoc,\r\n  addDoc,\r\n  runTransaction\r\n} from 'firebase/firestore';\r\nimport { formatDateToId } from '../utils/idHelpers';\r\n\r\n/* ============================\r\n   Collection reference helpers\r\n   ============================ */\r\nfunction patientsCollectionRef(clinicId) {\r\n  return collection(db, 'clinics', clinicId, 'patients');\r\n}\r\nfunction appointmentsCollectionRef(clinicId) {\r\n  return collection(db, 'clinics', clinicId, 'appointments');\r\n}\r\nfunction drugsCollectionRef(clinicId) {\r\n  return collection(db, 'clinics', clinicId, 'drugs');\r\n}\r\nfunction consultationsCollectionRef(clinicId) {\r\n  return collection(db, 'clinics', clinicId, 'consultations');\r\n}\r\nfunction prescriptionsCollectionRef(clinicId) {\r\n  return collection(db, 'clinics', clinicId, 'prescriptions');\r\n}\r\nfunction invoicesCollectionRef(clinicId) {\r\n  return collection(db, 'clinics', clinicId, 'invoices');\r\n}\r\n\r\n/* ============================\r\n   Patients\r\n   ============================ */\r\n\r\n/* Patients: subscribe live */\r\nexport function subscribePatients(clinicId, callback, onError) {\r\n  if (!clinicId) {\r\n    if (onError) onError(new Error('clinicId required'));\r\n    return () => {};\r\n  }\r\n  const q = query(patientsCollectionRef(clinicId), orderBy('createdAt', 'desc'));\r\n  const unsub = onSnapshot(q, (snap) => {\r\n    const items = snap.docs.map((d) => ({ id: d.id, ...d.data() }));\r\n    callback(items);\r\n  }, onError);\r\n  return unsub;\r\n}\r\n\r\n/* fetch once */\r\nexport async function fetchPatientsOnce(clinicId) {\r\n  if (!clinicId) throw new Error('clinicId required');\r\n  const q = query(patientsCollectionRef(clinicId), orderBy('createdAt', 'desc'));\r\n  const snap = await getDocs(q);\r\n  return snap.docs.map((d) => ({ id: d.id, ...d.data() }));\r\n}\r\n\r\n/* create or update patient (patient.nic used as doc id) */\r\nexport async function createOrUpdatePatient(clinicId, patient, createdByEmail = null) {\r\n  if (!clinicId) throw new Error('clinicId required');\r\n  if (!patient || !patient.nic) throw new Error('patient.nic (NIC) required');\r\n\r\n  const patientId = String(patient.nic).trim();\r\n  const ref = doc(db, 'clinics', clinicId, 'patients', patientId);\r\n\r\n  const now = new Date();\r\n  const payload = {\r\n    ...patient,\r\n    nic: patientId,\r\n    updatedAt: now.toISOString(),\r\n    createdAt: patient.createdAt ?? now.toISOString(),\r\n    createdBy: patient.createdBy ?? createdByEmail ?? null\r\n  };\r\n  await setDoc(ref, payload, { merge: true });\r\n  return { id: patientId, ...payload };\r\n}\r\n\r\n/* get single patient */\r\nexport async function getPatient(clinicId, patientNic) {\r\n  if (!clinicId) throw new Error('clinicId required');\r\n  const ref = doc(db, 'clinics', clinicId, 'patients', String(patientNic));\r\n  const snap = await getDoc(ref);\r\n  if (!snap.exists()) return null;\r\n  return { id: snap.id, ...snap.data() };\r\n}\r\n\r\n/* update patient fields */\r\nexport async function updatePatient(clinicId, patientNic, data) {\r\n  if (!clinicId) throw new Error('clinicId required');\r\n  const ref = doc(db, 'clinics', clinicId, 'patients', String(patientNic));\r\n  await updateDoc(ref, { ...data, updatedAt: new Date().toISOString() });\r\n  const snap = await getDoc(ref);\r\n  return { id: snap.id, ...snap.data() };\r\n}\r\n\r\n/* ============================\r\n   Appointments\r\n   ============================ */\r\n\r\n/* Appointments: create using scheduledAt -> YYYYMMDDHHMMSS id */\r\nexport async function createAppointment(clinicId, { patientNic, scheduledAtISO, receptionistEmail = null, notes = '', status = 'confirmed' }) {\r\n  if (!clinicId) throw new Error('clinicId required');\r\n  if (!patientNic) throw new Error('patientNic required');\r\n\r\n  const scheduledDate = (scheduledAtISO instanceof Date) ? scheduledAtISO : new Date(scheduledAtISO);\r\n  if (Number.isNaN(scheduledDate.getTime())) throw new Error('Invalid scheduledAt value');\r\n\r\n  const appointmentId = formatDateToId(scheduledDate);\r\n  const ref = doc(db, 'clinics', clinicId, 'appointments', appointmentId);\r\n\r\n  const payload = {\r\n    patientNic: String(patientNic).trim(),\r\n    scheduledAt: scheduledDate.toISOString(),\r\n    status,\r\n    receptionistEmail,\r\n    notes,\r\n    createdAt: new Date().toISOString()\r\n  };\r\n\r\n  await setDoc(ref, payload, { merge: false });\r\n  return { id: appointmentId, ...payload };\r\n}\r\n\r\n/* fetch appointments for a patient (once) — client-side sort */\r\nexport async function fetchAppointmentsForPatient(clinicId, patientNic) {\r\n  if (!clinicId) throw new Error('clinicId required');\r\n  const coll = appointmentsCollectionRef(clinicId);\r\n  const q = query(coll, where('patientNic', '==', String(patientNic)));\r\n  const snap = await getDocs(q);\r\n  const items = snap.docs.map((d) => ({ id: d.id, ...d.data() }));\r\n  items.sort((a, b) => (b.scheduledAt || '').localeCompare(a.scheduledAt || ''));\r\n  return items;\r\n}\r\n\r\n/* subscribe appointments for a patient (live) — client-side sort */\r\nexport function subscribeAppointmentsForPatient(clinicId, patientNic, callback, onError) {\r\n  if (!clinicId) {\r\n    if (onError) onError(new Error('clinicId required'));\r\n    return () => {};\r\n  }\r\n  const coll = appointmentsCollectionRef(clinicId);\r\n  const q = query(coll, where('patientNic', '==', String(patientNic)));\r\n  const unsub = onSnapshot(q, (snap) => {\r\n    const items = snap.docs.map((d) => ({ id: d.id, ...d.data() }));\r\n    items.sort((a, b) => (b.scheduledAt || '').localeCompare(a.scheduledAt || ''));\r\n    callback(items);\r\n  }, (err) => {\r\n    console.error('subscribeAppointmentsForPatient error', err);\r\n    if (onError) onError(err);\r\n  });\r\n  return unsub;\r\n}\r\n\r\n/* update appointment (partial) */\r\nexport async function updateAppointment(clinicId, appointmentId, data) {\r\n  if (!clinicId) throw new Error('clinicId required');\r\n  const ref = doc(db, 'clinics', clinicId, 'appointments', String(appointmentId));\r\n  await updateDoc(ref, { ...data, updatedAt: new Date().toISOString() });\r\n  const snap = await getDoc(ref);\r\n  return { id: snap.id, ...snap.data() };\r\n}\r\n\r\n/* cancel appointment -> status = 'cancelled' */\r\nexport async function cancelAppointment(clinicId, appointmentId, cancelledByEmail = null) {\r\n  return updateAppointment(clinicId, appointmentId, { status: 'cancelled', cancelledBy: cancelledByEmail, cancelledAt: new Date().toISOString() });\r\n}\r\n\r\n/* delete appointment (if needed) */\r\nexport async function deleteAppointment(clinicId, appointmentId) {\r\n  if (!clinicId) throw new Error('clinicId required');\r\n  const ref = doc(db, 'clinics', clinicId, 'appointments', String(appointmentId));\r\n  await deleteDoc(ref);\r\n  return true;\r\n}\r\n\r\n/* ============================\r\n   Date-based appointment helpers\r\n   ============================ */\r\n\r\n/**\r\n * Fetch appointments for a specific date (ISO date string or Date object)\r\n * Returns appointments ordered by scheduledAt ascending.\r\n */\r\nexport async function fetchAppointmentsByDate(clinicId, date) {\r\n  if (!clinicId) throw new Error('clinicId required');\r\n  const d = (date instanceof Date) ? date : new Date(date);\r\n  const start = new Date(d); start.setHours(0,0,0,0);\r\n  const end = new Date(d); end.setHours(23,59,59,999);\r\n\r\n  const coll = appointmentsCollectionRef(clinicId);\r\n  const q = query(coll, where('scheduledAt', '>=', start.toISOString()), where('scheduledAt', '<=', end.toISOString()));\r\n  const snap = await getDocs(q);\r\n  const items = snap.docs.map(doc => ({ id: doc.id, ...doc.data() }));\r\n  items.sort((a,b) => (a.scheduledAt || '').localeCompare(b.scheduledAt || ''));\r\n  return items;\r\n}\r\n\r\n/**\r\n * Subscribe to appointments for a specific date (real-time)\r\n * callback(items) on update\r\n */\r\nexport function subscribeAppointmentsByDate(clinicId, date, callback, onError) {\r\n  if (!clinicId) {\r\n    if (onError) onError(new Error('clinicId required'));\r\n    return () => {};\r\n  }\r\n  const d = (date instanceof Date) ? date : new Date(date);\r\n  const start = new Date(d); start.setHours(0,0,0,0);\r\n  const end = new Date(d); end.setHours(23,59,59,999);\r\n\r\n  const coll = appointmentsCollectionRef(clinicId);\r\n  const q = query(coll, where('scheduledAt', '>=', start.toISOString()), where('scheduledAt', '<=', end.toISOString()));\r\n  const unsub = onSnapshot(q, (snap) => {\r\n    const items = snap.docs.map(dd => ({ id: dd.id, ...dd.data() }));\r\n    items.sort((a,b) => (a.scheduledAt || '').localeCompare(b.scheduledAt || ''));\r\n    callback(items);\r\n  }, (err) => {\r\n    console.error('subscribeAppointmentsByDate error', err);\r\n    if (onError) onError(err);\r\n  });\r\n  return unsub;\r\n}\r\n\r\n/* ============================\r\n   Consultations\r\n   ============================ */\r\n\r\n/**\r\n * Create consultation document.\r\n * ID format: YYYYMMDDHHMMSS-<NIC>\r\n */\r\nexport async function createConsultation(clinicId, {\r\n  patientNic,\r\n  appointmentId = null,\r\n  doctorEmail = null,\r\n  presentComplaint = '',\r\n  examFindings = '',\r\n  differentialDiagnosis = '',\r\n  investigations = '',\r\n  management = ''\r\n} = {}) {\r\n  if (!clinicId) throw new Error('clinicId required');\r\n  if (!patientNic) throw new Error('patientNic required');\r\n\r\n  const now = new Date();\r\n  const id = formatDateToId(now) + '-' + String(patientNic);\r\n  const ref = doc(db, 'clinics', clinicId, 'consultations', id);\r\n\r\n  const docData = {\r\n    patientNic: String(patientNic),\r\n    appointmentId: appointmentId ?? null,\r\n    doctorEmail: doctorEmail ?? null,\r\n    presentComplaint,\r\n    examFindings,\r\n    differentialDiagnosis,\r\n    investigations,\r\n    management,\r\n    createdAt: now.toISOString(),\r\n    updatedAt: now.toISOString()\r\n  };\r\n\r\n  await setDoc(ref, docData, { merge: false });\r\n  return { id, ...docData };\r\n}\r\n\r\n/**\r\n * Fetch consultations for a patient (latest first)\r\n */\r\nexport async function fetchConsultationsForPatient(clinicId, patientNic) {\r\n  if (!clinicId) throw new Error('clinicId required');\r\n  if (!patientNic) throw new Error('patientNic required');\r\n\r\n  const coll = consultationsCollectionRef(clinicId);\r\n  const q = query(coll, where('patientNic', '==', String(patientNic)));\r\n  const snap = await getDocs(q);\r\n  const items = snap.docs.map(d => ({ id: d.id, ...d.data() }));\r\n  items.sort((a,b) => (b.createdAt || '').localeCompare(a.createdAt || ''));\r\n  return items;\r\n}\r\n\r\n/**\r\n * Subscribe consultations for a patient (real-time)\r\n */\r\nexport function subscribeConsultationsForPatient(clinicId, patientNic, callback, onError) {\r\n  if (!clinicId) {\r\n    if (onError) onError(new Error('clinicId required'));\r\n    return () => {};\r\n  }\r\n  const coll = consultationsCollectionRef(clinicId);\r\n  const q = query(coll, where('patientNic', '==', String(patientNic)));\r\n  const unsub = onSnapshot(q, (snap) => {\r\n    const items = snap.docs.map(d => ({ id: d.id, ...d.data() }));\r\n    items.sort((a,b) => (b.createdAt || '').localeCompare(a.createdAt || ''));\r\n    callback(items);\r\n  }, (err) => {\r\n    console.error('subscribeConsultationsForPatient error', err);\r\n    if (onError) onError(err);\r\n  });\r\n  return unsub;\r\n}\r\n\r\n/* ============================\r\n   Prescriptions\r\n   ============================ */\r\n\r\n/**\r\n * Create prescription document (doctor creates from consultation)\r\n * id format: YYYYMMDDHHMMSS-<NIC>\r\n * Stored under clinics/{clinicId}/prescriptions/{prescId}\r\n */\r\nexport async function createPrescription(clinicId, { consultationId = null, patientNic, doctorEmail = null, rawManagement = '', items = [] } = {}) {\r\n  if (!clinicId) throw new Error('clinicId required');\r\n  if (!patientNic) throw new Error('patientNic required');\r\n\r\n  const now = new Date();\r\n  const prescId = formatDateToId(now) + '-' + String(patientNic);\r\n  const ref = doc(db, 'clinics', clinicId, 'prescriptions', prescId);\r\n\r\n  // compute subtotal if items provided\r\n  let subtotal = 0;\r\n  const normalizedItems = (Array.isArray(items) ? items : []).map(it => {\r\n    const unitPrice = Number(it.unitPrice || 0) || 0;\r\n    const qty = Number(it.qty || 0) || 0;\r\n    const lineTotal = unitPrice * qty;\r\n    subtotal += lineTotal;\r\n    return {\r\n      drugId: it.drugId ?? null,\r\n      drugName: it.drugName ?? (it.name ?? ''),\r\n      dose: it.dose ?? '',\r\n      qty,\r\n      unitPrice,\r\n      lineTotal,\r\n      raw: it.raw ?? null\r\n    };\r\n  });\r\n\r\n  const docData = {\r\n    consultationId,\r\n    patientNic: String(patientNic),\r\n    doctorEmail: doctorEmail ?? null,\r\n    rawManagement: rawManagement ?? '',\r\n    items: normalizedItems,\r\n    subtotal,\r\n    tax: 0,\r\n    total: subtotal,\r\n    status: 'pending',\r\n    createdAt: now.toISOString()\r\n  };\r\n\r\n  await setDoc(ref, docData, { merge: false });\r\n  return { id: prescId, ...docData };\r\n}\r\n\r\n/**\r\n * Subscribe pending prescriptions (pharmacist)\r\n */\r\nexport function subscribePendingPrescriptions(clinicId, callback, onError) {\r\n  if (!clinicId) {\r\n    if (onError) onError(new Error('clinicId required'));\r\n    return () => {};\r\n  }\r\n  const coll = prescriptionsCollectionRef(clinicId);\r\n  const q = query(coll, where('status', '==', 'pending'), orderBy('createdAt', 'asc'));\r\n  const unsub = onSnapshot(q, (snap) => {\r\n    const items = snap.docs.map(d => ({ id: d.id, ...d.data() }));\r\n    callback(items);\r\n  }, (err) => {\r\n    console.error('subscribePendingPrescriptions error', err);\r\n    if (onError) onError(err);\r\n  });\r\n  return unsub;\r\n}\r\n\r\n/* ============================\r\n   Drugs (inventory)\r\n   ============================ */\r\n\r\n/* Subscribe / fetch drugs list */\r\nexport function subscribeDrugs(clinicId, callback, onError) {\r\n  if (!clinicId) {\r\n    if (onError) onError(new Error('clinicId required'));\r\n    return () => {};\r\n  }\r\n  const coll = drugsCollectionRef(clinicId);\r\n  const q = query(coll, orderBy('name', 'asc'));\r\n  const unsub = onSnapshot(q, (snap) => {\r\n    const items = snap.docs.map(d => ({ id: d.id, ...d.data() }));\r\n    callback(items);\r\n  }, onError);\r\n  return unsub;\r\n}\r\n\r\nexport async function fetchDrugsOnce(clinicId) {\r\n  if (!clinicId) throw new Error('clinicId required');\r\n  const coll = drugsCollectionRef(clinicId);\r\n  const q = query(coll, orderBy('name', 'asc'));\r\n  const snap = await getDocs(q);\r\n  return snap.docs.map(d => ({ id: d.id, ...d.data() }));\r\n}\r\n\r\nexport async function createOrUpdateDrug(clinicId, drugIdOrName, { name, dose, qtyAvailable = 0, pricePerUnit = 0, updatedBy = null } = {}) {\r\n  if (!clinicId) throw new Error('clinicId required');\r\n  const id = String(drugIdOrName).trim();\r\n  const ref = doc(db, 'clinics', clinicId, 'drugs', id);\r\n  const payload = {\r\n    name: name ?? id,\r\n    dose: dose ?? '',\r\n    qtyAvailable: Number(qtyAvailable) || 0,\r\n    pricePerUnit: Number(pricePerUnit) || 0,\r\n    updatedAt: new Date().toISOString(),\r\n    updatedBy: updatedBy ?? null\r\n  };\r\n  await setDoc(ref, payload, { merge: true });\r\n  return { id, ...payload };\r\n}\r\n\r\n/* ============================\r\n   Stock transactions: decrement / increment\r\n   ============================ */\r\n\r\n/**\r\n * Decrement drug stock atomically using a transaction.\r\n * Ensures stock never goes negative.\r\n *\r\n * Returns the new qtyAvailable after decrement.\r\n */\r\nexport async function decrementDrugStock(clinicId, drugId, decQty = 1) {\r\n  if (!clinicId) throw new Error('clinicId required');\r\n  if (!drugId) throw new Error('drugId required');\r\n  decQty = Number(decQty) || 0;\r\n  if (decQty <= 0) throw new Error('decQty must be > 0');\r\n\r\n  const drugRef = doc(db, 'clinics', clinicId, 'drugs', String(drugId));\r\n\r\n  const result = await runTransaction(db, async (tx) => {\r\n    const snap = await tx.get(drugRef);\r\n    if (!snap.exists()) throw new Error('Drug not found');\r\n    const data = snap.data();\r\n    const current = Number(data.qtyAvailable || 0);\r\n    if (current < decQty) throw new Error(`Insufficient stock for ${data.name || drugId} (need ${decQty}, have ${current})`);\r\n    const newQty = current - decQty;\r\n    tx.update(drugRef, { qtyAvailable: newQty, updatedAt: new Date().toISOString() });\r\n    return newQty;\r\n  });\r\n\r\n  return result; // number\r\n}\r\n\r\n/**\r\n * Increment drug stock atomically using a transaction.\r\n * Use when removing items from cart / restocking.\r\n *\r\n * @returns {number} newQty\r\n */\r\nexport async function incrementDrugStock(clinicId, drugId, incQty = 1) {\r\n  if (!clinicId) throw new Error('clinicId required');\r\n  if (!drugId) throw new Error('drugId required');\r\n  incQty = Number(incQty) || 0;\r\n  if (incQty <= 0) throw new Error('incQty must be > 0');\r\n\r\n  const drugRef = doc(db, 'clinics', clinicId, 'drugs', String(drugId));\r\n\r\n  const result = await runTransaction(db, async (tx) => {\r\n    const snap = await tx.get(drugRef);\r\n    if (!snap.exists()) throw new Error('Drug not found');\r\n    const data = snap.data();\r\n    const current = Number(data.qtyAvailable || 0);\r\n    const newQty = current + incQty;\r\n    tx.update(drugRef, { qtyAvailable: newQty, updatedAt: new Date().toISOString() });\r\n    return newQty;\r\n  });\r\n\r\n  return result;\r\n}\r\n\r\n/* ============================\r\n   Issue prescription transaction\r\n   ============================ */\r\n\r\n/**\r\n * issuePrescriptionTransaction\r\n * - clinicId\r\n * - prescriptionId\r\n * - pharmacistEmail\r\n * - items: [{ drugId, qty }]  // items to issue; caller should provide qty and drugId\r\n *\r\n * Behavior (atomic transaction):\r\n *  - verify prescription exists and is pending\r\n *  - load each drug doc and ensure qtyAvailable >= qty requested\r\n *  - decrement qtyAvailable for each drug\r\n *  - create invoice doc (id format formatDateToId + -patientNic)\r\n *  - update prescription status -> 'issued', set issuedAt, issuedBy, invoiceId\r\n *  - return invoice summary\r\n */\r\nexport async function issuePrescriptionTransaction(clinicId, prescriptionId, pharmacistEmail, items = []) {\r\n  if (!clinicId) throw new Error('clinicId required');\r\n  if (!prescriptionId) throw new Error('prescriptionId required');\r\n  if (!Array.isArray(items) || items.length === 0) throw new Error('items required');\r\n\r\n  const prescRef = doc(db, 'clinics', clinicId, 'prescriptions', prescriptionId);\r\n\r\n  const result = await runTransaction(db, async (tx) => {\r\n    const prescSnap = await tx.get(prescRef);\r\n    if (!prescSnap.exists()) throw new Error('Prescription not found');\r\n    const presc = prescSnap.data();\r\n\r\n    if (presc.status === 'issued') throw new Error('Prescription already issued');\r\n\r\n    // Prepare drug refs and read them\r\n    const drugRefs = items.map(i => doc(db, 'clinics', clinicId, 'drugs', String(i.drugId)));\r\n    const drugSnaps = [];\r\n    for (const r of drugRefs) {\r\n      const s = await tx.get(r);\r\n      drugSnaps.push(s);\r\n    }\r\n\r\n    // Check availability\r\n    for (let i = 0; i < items.length; i++) {\r\n      const it = items[i];\r\n      const snap = drugSnaps[i];\r\n      if (!snap.exists()) throw new Error(`Drug not found: ${it.drugId}`);\r\n      const d = snap.data();\r\n      const available = Number(d.qtyAvailable || 0);\r\n      const needed = Number(it.qty || 0);\r\n      if (needed <= 0) throw new Error(`Invalid qty for ${it.drugId}`);\r\n      if (available < needed) throw new Error(`Insufficient stock for ${d.name} (need ${needed}, have ${available})`);\r\n    }\r\n\r\n    // Compute line items and totals\r\n    const lineItems = [];\r\n    let subtotal = 0;\r\n    for (let i = 0; i < items.length; i++) {\r\n      const it = items[i];\r\n      const snap = drugSnaps[i];\r\n      const d = snap.data();\r\n      const unitPrice = Number(d.pricePerUnit || 0);\r\n      const qty = Number(it.qty || 0);\r\n      const lineTotal = unitPrice * qty;\r\n      subtotal += lineTotal;\r\n      lineItems.push({\r\n        drugId: String(it.drugId),\r\n        drugName: d.name,\r\n        dose: d.dose || '',\r\n        qty,\r\n        unitPrice,\r\n        lineTotal\r\n      });\r\n    }\r\n\r\n    // Create invoice id\r\n    const now = new Date();\r\n    const invoiceId = formatDateToId(now) + '-' + String(presc.patientNic || 'unknown');\r\n\r\n    const invRef = doc(db, 'clinics', clinicId, 'invoices', invoiceId);\r\n\r\n    const invoiceDoc = {\r\n      prescriptionId,\r\n      patientNic: presc.patientNic,\r\n      pharmacistEmail,\r\n      createdAt: now.toISOString(),\r\n      items: lineItems,\r\n      subtotal,\r\n      tax: 0,\r\n      total: subtotal,\r\n      status: 'unpaid'\r\n    };\r\n\r\n    // Decrement stocks\r\n    for (let i = 0; i < items.length; i++) {\r\n      const it = items[i];\r\n      const r = drugRefs[i];\r\n      const snap = drugSnaps[i];\r\n      const current = Number(snap.data().qtyAvailable || 0);\r\n      const newQty = current - Number(it.qty || 0);\r\n      tx.update(r, { qtyAvailable: newQty, updatedAt: new Date().toISOString() });\r\n    }\r\n\r\n    // Create invoice\r\n    tx.set(invRef, invoiceDoc);\r\n\r\n    // Update prescription to issued\r\n    tx.update(prescRef, {\r\n      status: 'issued',\r\n      issuedAt: now.toISOString(),\r\n      issuedBy: pharmacistEmail,\r\n      invoiceId\r\n    });\r\n\r\n    // Optionally link invoiceId into consultation doc\r\n    if (presc.consultationId) {\r\n      const consultRef = doc(db, 'clinics', clinicId, 'consultations', presc.consultationId);\r\n      const consultSnap = await tx.get(consultRef);\r\n      if (consultSnap.exists()) {\r\n        tx.update(consultRef, { invoiceId });\r\n      }\r\n    }\r\n\r\n    return {\r\n      invoiceId,\r\n      invoice: invoiceDoc\r\n    };\r\n  });\r\n\r\n  return result;\r\n}\r\n\r\n/* ============================\r\n   Fetch helpers: one-off / subscription\r\n   ============================ */\r\n\r\n/* -- already have subscribePatients, subscribeDrugs, subscribePendingPrescriptions, subscribeConsultationsForPatient, etc. -- */\r\n\r\n/* Provide fetch functions for invoices if needed */\r\nexport async function fetchInvoicesForPatient(clinicId, patientNic) {\r\n  if (!clinicId) throw new Error('clinicId required');\r\n  if (!patientNic) throw new Error('patientNic required');\r\n  const coll = invoicesCollectionRef(clinicId);\r\n  const q = query(coll, where('patientNic', '==', String(patientNic)));\r\n  const snap = await getDocs(q);\r\n  return snap.docs.map(d => ({ id: d.id, ...d.data() }));\r\n}\r\n\r\n/* ============================\r\n   Exports (already named exports above)\r\n   ============================ */\r\n\r\n// Note: all functions are exported as named exports above.\r\n// No default export.\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 629, "column": 0}, "map": {"version":3,"sources":["file:///D:/Education/WebDev%20with%20AI/Projects/clinic-suite/components/NewPatientForm.js"],"sourcesContent":["// components/NewPatientForm.js\r\n'use client';\r\n\r\nimport { useEffect, useState } from 'react';\r\n\r\nexport default function NewPatientForm({ onSubmit, disabled = false, initial = null }) {\r\n  const [firstName, setFirstName] = useState(initial?.firstName ?? '');\r\n  const [lastName, setLastName] = useState(initial?.lastName ?? '');\r\n  const [nic, setNic] = useState(initial?.nic ?? '');\r\n  const [dob, setDob] = useState(initial?.dob ?? '');\r\n  const [gender, setGender] = useState(initial?.gender ?? '');\r\n  const [phone, setPhone] = useState(initial?.phone ?? '');\r\n  const [address, setAddress] = useState(initial?.address ?? '');\r\n  const [allergies, setAllergies] = useState((initial?.allergies ?? []).join(', '));\r\n  const [submitting, setSubmitting] = useState(false);\r\n  const [error, setError] = useState(null);\r\n\r\n  useEffect(() => {\r\n    if (initial) {\r\n      setFirstName(initial.firstName ?? ''); setLastName(initial.lastName ?? '');\r\n      setNic(initial.nic ?? ''); setDob(initial.dob ?? ''); setGender(initial.gender ?? '');\r\n      setPhone(initial.phone ?? ''); setAddress(initial.address ?? ''); setAllergies((initial.allergies ?? []).join(', '));\r\n    }\r\n  }, [initial]);\r\n\r\n  async function handleSubmit(e) {\r\n    e.preventDefault();\r\n    setError(null);\r\n    if (!nic) return setError('NIC is required.');\r\n    const payload = {\r\n      firstName: firstName.trim(),\r\n      lastName: lastName.trim(),\r\n      nic: nic.trim(),\r\n      dob: dob || null, gender: gender || null, phone: phone || null,\r\n      address: address || null, allergies: allergies ? allergies.split(',').map(s=>s.trim()).filter(Boolean) : []\r\n    };\r\n    setSubmitting(true);\r\n    try {\r\n      await onSubmit(payload);\r\n      // keep NIC in form to create multiple appointments if needed\r\n      // clear others\r\n      // setFirstName(''); setLastName(''); setDob(''); setGender(''); setPhone(''); setAddress(''); setAllergies('');\r\n      alert('Patient saved.');\r\n    } catch (err) {\r\n      setError(err.message || String(err));\r\n    } finally { setSubmitting(false); }\r\n  }\r\n\r\n  return (\r\n    <form onSubmit={handleSubmit} className=\"space-y-2\">\r\n      <input value={nic} onChange={(e)=>setNic(e.target.value)} placeholder=\"NIC (ID)\" className=\"w-full p-2 border rounded\" />\r\n      <div className=\"grid grid-cols-2 gap-2\">\r\n        <input value={firstName} onChange={(e)=>setFirstName(e.target.value)} placeholder=\"First name\" className=\"p-2 border rounded\" />\r\n        <input value={lastName} onChange={(e)=>setLastName(e.target.value)} placeholder=\"Last name\" className=\"p-2 border rounded\" />\r\n      </div>\r\n      <div className=\"grid grid-cols-2 gap-2\">\r\n        <input type=\"date\" value={dob} onChange={(e)=>setDob(e.target.value)} className=\"p-2 border rounded\" />\r\n        <select value={gender} onChange={(e)=>setGender(e.target.value)} className=\"p-2 border rounded\">\r\n          <option value=\"\">Gender</option>\r\n          <option value=\"M\">Male</option><option value=\"F\">Female</option><option value=\"O\">Other</option>\r\n        </select>\r\n      </div>\r\n      <input value={phone} onChange={(e)=>setPhone(e.target.value)} placeholder=\"Phone\" className=\"p-2 border rounded\" />\r\n      <input value={address} onChange={(e)=>setAddress(e.target.value)} placeholder=\"Address\" className=\"p-2 border rounded\" />\r\n      <input value={allergies} onChange={(e)=>setAllergies(e.target.value)} placeholder=\"Allergies (comma separated)\" className=\"p-2 border rounded\" />\r\n      {error && <div className=\"text-sm text-red-600\">{error}</div>}\r\n      <div className=\"text-right\">\r\n        <button disabled={disabled || submitting} type=\"submit\" className=\"px-4 py-2 rounded-md bg-indigo-600 text-white\">{submitting ? 'Saving...' : 'Save patient'}</button>\r\n      </div>\r\n    </form>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 873, "column": 0}, "map": {"version":3,"sources":["file:///D:/Education/WebDev%20with%20AI/Projects/clinic-suite/components/PatientSidebar.js"],"sourcesContent":["// components/PatientSidebar.js\r\n'use client';\r\n\r\nimport NewPatientForm from './NewPatientForm';\r\nimport { useState } from 'react';\r\n\r\nexport default function PatientSidebar({ patients = [], query = '', onQuery, onSelect, selectedId, onOpenCreate, disabled }) {\r\n  const [openCreateInline, setOpenCreateInline] = useState(false);\r\n\r\n  return (\r\n    <div className=\"space-y-4\">\r\n      <div className=\"rounded-xl bg-white p-4 shadow-sm\">\r\n        <div className=\"flex items-center justify-between\">\r\n          <div>\r\n            <div className=\"text-sm font-medium text-slate-800\">Patients</div>\r\n            <div className=\"text-xs text-slate-400\">Search and manage patients</div>\r\n          </div>\r\n          <button onClick={() => { setOpenCreateInline(false); onOpenCreate(); }} className=\"text-xs px-2 py-1 border rounded text-slate-700\">+ New</button>\r\n        </div>\r\n\r\n        <div className=\"mt-3\">\r\n          <input value={query} onChange={(e) => onQuery(e.target.value)} placeholder=\"Search by name / NIC\" className=\"w-full p-2 rounded-md border border-slate-100 focus:ring-1 focus:ring-indigo-300\" />\r\n        </div>\r\n\r\n        {openCreateInline && (\r\n          <div className=\"mt-4\">\r\n            <NewPatientForm onSubmit={async (p) => { if (onOpenCreate) onOpenCreate(); }} disabled={disabled} />\r\n          </div>\r\n        )}\r\n      </div>\r\n\r\n      <div className=\"rounded-xl bg-white p-2 shadow-sm max-h-[65vh] overflow-auto\">\r\n        <div className=\"divide-y divide-slate-100\">\r\n          {patients.length === 0 && <div className=\"p-4 text-sm text-slate-400\">No patients</div>}\r\n          {patients.map(p => (\r\n            <div key={p.id} onClick={() => onSelect(p)} className={`p-3 cursor-pointer hover:bg-slate-50 flex items-center gap-3 ${selectedId === p.id ? 'bg-slate-50' : ''}`}>\r\n              <div className=\"w-10 h-10 rounded-full bg-slate-100 flex items-center justify-center text-slate-600 font-medium\">{(p.firstName || p.nic || 'P').charAt(0).toUpperCase()}</div>\r\n              <div className=\"flex-1\">\r\n                <div className=\"text-sm font-medium text-slate-800\">{p.firstName ? `${p.firstName} ${p.lastName ?? ''}` : 'Unnamed'}</div>\r\n                <div className=\"text-xs text-slate-400\">{p.id} · {p.phone ?? '—'}</div>\r\n              </div>\r\n              <div className=\"text-xs text-slate-400\">{p.updatedAt ? new Date(p.updatedAt).toLocaleDateString() : ''}</div>\r\n            </div>\r\n          ))}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"AAAA,+BAA+B;;;;;;AAG/B;AACA;;;AAHA;;;AAKe,SAAS,eAAe,EAAE,WAAW,EAAE,EAAE,QAAQ,EAAE,EAAE,OAAO,EAAE,QAAQ,EAAE,UAAU,EAAE,YAAY,EAAE,QAAQ,EAAE;;IACzH,MAAM,CAAC,kBAAkB,oBAAoB,GAAG,IAAA,4LAAQ,EAAC;IAEzD,qBACE,gNAAC;QAAI,WAAU;;0BACb,gNAAC;gBAAI,WAAU;;kCACb,gNAAC;wBAAI,WAAU;;0CACb,gNAAC;;kDACC,gNAAC;wCAAI,WAAU;kDAAqC;;;;;;kDACpD,gNAAC;wCAAI,WAAU;kDAAyB;;;;;;;;;;;;0CAE1C,gNAAC;gCAAO,SAAS;oCAAQ,oBAAoB;oCAAQ;gCAAgB;gCAAG,WAAU;0CAAkD;;;;;;;;;;;;kCAGtI,gNAAC;wBAAI,WAAU;kCACb,cAAA,gNAAC;4BAAM,OAAO;4BAAO,UAAU,CAAC,IAAM,QAAQ,EAAE,MAAM,CAAC,KAAK;4BAAG,aAAY;4BAAuB,WAAU;;;;;;;;;;;oBAG7G,kCACC,gNAAC;wBAAI,WAAU;kCACb,cAAA,gNAAC,6JAAc;4BAAC,UAAU,OAAO;gCAAQ,IAAI,cAAc;4BAAgB;4BAAG,UAAU;;;;;;;;;;;;;;;;;0BAK9F,gNAAC;gBAAI,WAAU;0BACb,cAAA,gNAAC;oBAAI,WAAU;;wBACZ,SAAS,MAAM,KAAK,mBAAK,gNAAC;4BAAI,WAAU;sCAA6B;;;;;;wBACrE,SAAS,GAAG,CAAC,CAAA,kBACZ,gNAAC;gCAAe,SAAS,IAAM,SAAS;gCAAI,WAAW,CAAC,6DAA6D,EAAE,eAAe,EAAE,EAAE,GAAG,gBAAgB,IAAI;;kDAC/J,gNAAC;wCAAI,WAAU;kDAAmG,CAAC,EAAE,SAAS,IAAI,EAAE,GAAG,IAAI,GAAG,EAAE,MAAM,CAAC,GAAG,WAAW;;;;;;kDACrK,gNAAC;wCAAI,WAAU;;0DACb,gNAAC;gDAAI,WAAU;0DAAsC,EAAE,SAAS,GAAG,GAAG,EAAE,SAAS,CAAC,CAAC,EAAE,EAAE,QAAQ,IAAI,IAAI,GAAG;;;;;;0DAC1G,gNAAC;gDAAI,WAAU;;oDAA0B,EAAE,EAAE;oDAAC;oDAAI,EAAE,KAAK,IAAI;;;;;;;;;;;;;kDAE/D,gNAAC;wCAAI,WAAU;kDAA0B,EAAE,SAAS,GAAG,IAAI,KAAK,EAAE,SAAS,EAAE,kBAAkB,KAAK;;;;;;;+BAN5F,EAAE,EAAE;;;;;;;;;;;;;;;;;;;;;;AAa1B;GA1CwB;KAAA"}},
    {"offset": {"line": 1077, "column": 0}, "map": {"version":3,"sources":["file:///D:/Education/WebDev%20with%20AI/Projects/clinic-suite/components/NewAppointmentForm.js"],"sourcesContent":["// components/NewAppointmentForm.js\r\n'use client';\r\n\r\nimport { useEffect, useState } from 'react';\r\n\r\n/**\r\n * Props:\r\n *  - patientNic (string) optional (display-only)\r\n *  - initialAppointment (object) optional — when set, form pre-fills for edit\r\n *      expected shape: { id, scheduledAt (ISO), notes, status }\r\n *  - onSubmit({ mode: 'create', data }) or onSubmit({ mode: 'update', appointmentId, data })\r\n *  - disabled (bool)\r\n */\r\nexport default function NewAppointmentForm({ patientNic, initialAppointment = null, onSubmit, disabled = false }) {\r\n  const [datetimeLocal, setDatetimeLocal] = useState('');\r\n  const [notes, setNotes] = useState('');\r\n  const [status, setStatus] = useState('confirmed');\r\n  const [submitting, setSubmitting] = useState(false);\r\n  const [error, setError] = useState(null);\r\n\r\n  useEffect(() => {\r\n    if (initialAppointment) {\r\n      // convert ISO to input datetime-local format: YYYY-MM-DDTHH:mm\r\n      const d = new Date(initialAppointment.scheduledAt);\r\n      const pad = n => String(n).padStart(2, '0');\r\n      const val = `${d.getFullYear()}-${pad(d.getMonth()+1)}-${pad(d.getDate())}T${pad(d.getHours())}:${pad(d.getMinutes())}`;\r\n      setDatetimeLocal(val);\r\n      setNotes(initialAppointment.notes || '');\r\n      setStatus(initialAppointment.status || 'confirmed');\r\n    } else {\r\n      // default datetime: next quarter-hour\r\n      const d = new Date(); d.setMinutes(Math.ceil(d.getMinutes()/15)*15,0,0);\r\n      const pad = n => String(n).padStart(2,'0');\r\n      setDatetimeLocal(`${d.getFullYear()}-${pad(d.getMonth()+1)}-${pad(d.getDate())}T${pad(d.getHours())}:${pad(d.getMinutes())}`);\r\n      setNotes('');\r\n      setStatus('confirmed');\r\n    }\r\n    setError(null);\r\n  }, [initialAppointment]);\r\n\r\n  async function handleSubmit(e) {\r\n    e?.preventDefault();\r\n    setError(null);\r\n    const dt = new Date(datetimeLocal);\r\n    if (Number.isNaN(dt.getTime())) {\r\n      setError('Select valid date/time');\r\n      return;\r\n    }\r\n\r\n    const payload = {\r\n      scheduledAtISO: dt.toISOString(),\r\n      notes: notes || '',\r\n      status: status || 'confirmed'\r\n    };\r\n\r\n    setSubmitting(true);\r\n    try {\r\n      if (initialAppointment && initialAppointment.id) {\r\n        // update mode\r\n        await onSubmit({ mode: 'update', appointmentId: initialAppointment.id, data: payload });\r\n      } else {\r\n        // create mode\r\n        await onSubmit({ mode: 'create', data: payload });\r\n      }\r\n      // keep form values after create if desired; for new create we clear notes\r\n      if (!initialAppointment) setNotes('');\r\n    } catch (err) {\r\n      setError(err.message || String(err));\r\n    } finally {\r\n      setSubmitting(false);\r\n    }\r\n  }\r\n\r\n  return (\r\n    <form onSubmit={handleSubmit} className=\"space-y-3\">\r\n      {patientNic && <div className=\"text-sm text-slate-500\">Patient: <span className=\"font-medium\">{patientNic}</span></div>}\r\n      <div>\r\n        <label className=\"block text-xs text-slate-500 mb-1\">Date & time</label>\r\n        <input type=\"datetime-local\" value={datetimeLocal} onChange={(e)=>setDatetimeLocal(e.target.value)} className=\"w-full p-2 border rounded\" />\r\n      </div>\r\n\r\n      <div>\r\n        <label className=\"block text-xs text-slate-500 mb-1\">Notes</label>\r\n        <input value={notes} onChange={(e)=>setNotes(e.target.value)} placeholder=\"Notes (optional)\" className=\"w-full p-2 border rounded\" />\r\n      </div>\r\n\r\n      <div>\r\n        <label className=\"block text-xs text-slate-500 mb-1\">Status</label>\r\n        <select value={status} onChange={(e)=>setStatus(e.target.value)} className=\"w-full p-2 border rounded\">\r\n          <option value=\"confirmed\">Confirmed</option>\r\n          <option value=\"pending\">Pending</option>\r\n          <option value=\"completed\">Completed</option>\r\n          <option value=\"cancelled\">Cancelled</option>\r\n        </select>\r\n      </div>\r\n\r\n      {error && <div className=\"text-sm text-red-600\">{error}</div>}\r\n\r\n      <div className=\"flex gap-2 justify-end\">\r\n        <button type=\"submit\" disabled={disabled || submitting} className=\"px-3 py-2 rounded-md bg-indigo-600 text-white text-sm\">\r\n          {submitting ? (initialAppointment ? 'Saving...' : 'Creating...') : (initialAppointment ? 'Save changes' : 'Create appointment')}\r\n        </button>\r\n      </div>\r\n    </form>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1336, "column": 0}, "map": {"version":3,"sources":["file:///D:/Education/WebDev%20with%20AI/Projects/clinic-suite/components/PatientDetailCard.js"],"sourcesContent":["// components/PatientDetailCard.js\r\n'use client';\r\n\r\nimport { useState, useEffect } from 'react';\r\nimport NewAppointmentForm from './NewAppointmentForm';\r\nimport NewPatientForm from './NewPatientForm';\r\n\r\nexport default function PatientDetailCard({\r\n  patient,\r\n  isNew = false,\r\n  appointments = [],\r\n  onCreatePatient,\r\n  onUpdatePatient,\r\n  onCreateAppointment,\r\n  onAppointmentAction,\r\n  busy,\r\n  onCloseCreate\r\n}) {\r\n  const [edit, setEdit] = useState(false);\r\n  const [form, setForm] = useState(patient);\r\n  const [tab, setTab] = useState('active'); // 'active' | 'create'\r\n  const [editingAppointment, setEditingAppointment] = useState(null);\r\n\r\n  useEffect(() => {\r\n    setForm(patient);\r\n    setEdit(!!isNew); // auto-edit when creating\r\n    setTab(isNew ? 'create' : 'active');\r\n    setEditingAppointment(null);\r\n  }, [patient, isNew]);\r\n\r\n  function setField(k, v) { setForm(s => ({ ...s, [k]: v })); }\r\n\r\n  async function savePatient() {\r\n    // create vs update\r\n    const payload = {\r\n      firstName: form.firstName, lastName: form.lastName, phone: form.phone,\r\n      address: form.address, dob: form.dob, gender: form.gender,\r\n      allergies: Array.isArray(form.allergies) ? form.allergies : (form.allergies ? form.allergies.split(',').map(s=>s.trim()) : []),\r\n      nic: form.nic || form.id // ensure nic provided for create\r\n    };\r\n\r\n    if (isNew || !form.id) {\r\n      // create\r\n      const created = await onCreatePatient(payload);\r\n      // onCreatePatient returns created object; it will become selected by page\r\n      return created;\r\n    } else {\r\n      // update\r\n      const updated = await onUpdatePatient(payload);\r\n      return updated;\r\n    }\r\n  }\r\n\r\n  function cancelEdit() {\r\n    if (isNew) {\r\n      // close the create form\r\n      if (onCloseCreate) onCloseCreate();\r\n      return;\r\n    }\r\n    setForm(patient);\r\n    setEdit(false);\r\n  }\r\n\r\n  function startEditAppointment(appt) {\r\n    setEditingAppointment(appt);\r\n    setTab('create');\r\n  }\r\n\r\n  async function handleAppointmentFormSubmit(payload) {\r\n    if (payload.mode === 'create') {\r\n      await onCreateAppointment(payload.data);\r\n      setTab('active');\r\n    } else if (payload.mode === 'update') {\r\n      await onAppointmentAction(payload.appointmentId, 'update', payload.data);\r\n      setEditingAppointment(null);\r\n      setTab('active');\r\n    }\r\n  }\r\n\r\n  async function handleCancelAppointment(apptId) {\r\n    if (!confirm('Cancel this appointment?')) return;\r\n    await onAppointmentAction(apptId, 'cancel');\r\n  }\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      <div className=\"rounded-xl bg-white p-6 shadow-sm\">\r\n        <div className=\"flex items-start justify-between gap-4\">\r\n          <div>\r\n            <div className=\"text-xs text-slate-400\">{isNew ? 'New patient' : 'Patient'}</div>\r\n            <h1 className=\"text-2xl font-semibold text-slate-800\">{form.firstName ? `${form.firstName} ${form.lastName ?? ''}` : (isNew ? 'Create patient' : 'Unnamed')}</h1>\r\n            <div className=\"mt-1 text-sm text-slate-500\">NIC • {isNew ? (form.nic || 'not set') : form.id}</div>\r\n          </div>\r\n\r\n          <div className=\"flex items-center gap-2\">\r\n            {!edit ? (\r\n              <button onClick={() => setEdit(true)} className=\"px-3 py-1 rounded-md border text-sm\">Edit</button>\r\n            ) : (\r\n              <div className=\"flex items-center gap-2\">\r\n                <button onClick={async () => { await savePatient(); }} disabled={busy} className=\"px-3 py-1 rounded-md bg-indigo-600 text-white text-sm\">{busy ? 'Saving...' : (isNew ? 'Create' : 'Save')}</button>\r\n                <button onClick={cancelEdit} disabled={busy} className=\"px-3 py-1 rounded-md border text-sm text-slate-700\">Cancel</button>\r\n              </div>\r\n            )}\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"mt-6 grid grid-cols-1 md:grid-cols-3 gap-4\">\r\n          <div className=\"md:col-span-2\">\r\n            {edit ? (\r\n              // For create mode, show NIC input editable; for update NIC is read-only (stored in id)\r\n              <div className=\"space-y-3\">\r\n                <div className=\"grid grid-cols-1 gap-2\">\r\n                  <input value={form.nic ?? ''} onChange={(e)=>setField('nic', e.target.value)} placeholder=\"NIC (identifier)\" className=\"p-2 border rounded\" disabled={!isNew} />\r\n                </div>\r\n\r\n                <div className=\"grid grid-cols-2 gap-2\">\r\n                  <input value={form.firstName || ''} onChange={(e)=>setField('firstName', e.target.value)} placeholder=\"First name\" className=\"p-2 border rounded\" />\r\n                  <input value={form.lastName || ''} onChange={(e)=>setField('lastName', e.target.value)} placeholder=\"Last name\" className=\"p-2 border rounded\" />\r\n                </div>\r\n\r\n                <div className=\"grid grid-cols-2 gap-2\">\r\n                  <input type=\"date\" value={form.dob || ''} onChange={(e)=>setField('dob', e.target.value)} className=\"p-2 border rounded\" />\r\n                  <select value={form.gender || ''} onChange={(e)=>setField('gender', e.target.value)} className=\"p-2 border rounded\">\r\n                    <option value=\"\">Gender</option>\r\n                    <option value=\"M\">Male</option>\r\n                    <option value=\"F\">Female</option>\r\n                    <option value=\"O\">Other</option>\r\n                  </select>\r\n                </div>\r\n\r\n                <input value={form.phone || ''} onChange={(e)=>setField('phone', e.target.value)} placeholder=\"Phone\" className=\"p-2 border rounded w-full\" />\r\n                <input value={form.address || ''} onChange={(e)=>setField('address', e.target.value)} placeholder=\"Address\" className=\"p-2 border rounded w-full\" />\r\n                <input value={(form.allergies || []).join?.(', ') || form.allergies || ''} onChange={(e)=>setField('allergies', e.target.value.split(',').map(s=>s.trim()).filter(Boolean))} placeholder=\"Allergies (comma separated)\" className=\"p-2 border rounded w-full\" />\r\n              </div>\r\n            ) : (\r\n              <div className=\"space-y-2 text-sm text-slate-600\">\r\n                <div><strong>Phone</strong>: {form.phone || '—'}</div>\r\n                <div><strong>Address</strong>: {form.address || '—'}</div>\r\n                <div><strong>DOB</strong>: {form.dob || '—'}</div>\r\n                <div><strong>Gender</strong>: {form.gender || '—'}</div>\r\n                <div><strong>Allergies</strong>: {(form.allergies||[]).length ? (form.allergies||[]).join(', ') : 'None'}</div>\r\n              </div>\r\n            )}\r\n          </div>\r\n\r\n          <div>\r\n            <div className=\"rounded-md border p-3 bg-white text-sm text-slate-600\">\r\n              <div className=\"text-xs text-slate-400\">Summary</div>\r\n              <div className=\"mt-2\"><strong>Created:</strong> {form.createdAt ? new Date(form.createdAt).toLocaleString() : '—'}</div>\r\n              <div className=\"mt-1\"><strong>Updated:</strong> {form.updatedAt ? new Date(form.updatedAt).toLocaleString() : '—'}</div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Tabs: Active appointments / Create */}\r\n      <div className=\"rounded-xl bg-white p-4 shadow-sm\">\r\n        <div className=\"flex items-center justify-between\">\r\n          <div className=\"flex gap-3\">\r\n            <button onClick={() => { setTab('active'); setEditingAppointment(null); }} className={`px-3 py-1 text-sm ${tab==='active' ? 'bg-slate-100 rounded-md' : 'text-slate-500'}`}>Active Appointments</button>\r\n            <button onClick={() => { setTab('create'); setEditingAppointment(null); }} className={`px-3 py-1 text-sm ${tab==='create' ? 'bg-slate-100 rounded-md' : 'text-slate-500'}`}>Create New Appointment</button>\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"mt-4\">\r\n          {tab === 'active' && (\r\n            <>\r\n              <div className=\"text-sm text-slate-600\">Appointments for this patient</div>\r\n              <div className=\"mt-4 space-y-3\">\r\n                {appointments.length === 0 && <div className=\"text-sm text-slate-400\">No appointments.</div>}\r\n                {appointments.map(a => (\r\n                  <div key={a.id} className=\"p-3 border rounded-md flex justify-between items-start\">\r\n                    <div>\r\n                      <div className=\"text-sm font-medium\">{new Date(a.scheduledAt).toLocaleString()}</div>\r\n                      <div className=\"text-xs text-slate-500\">{a.notes || '—'}</div>\r\n                      <div className=\"text-xs text-slate-400 mt-1\">Status: {a.status}</div>\r\n                    </div>\r\n                    <div className=\"flex flex-col gap-2\">\r\n                      <button onClick={() => startEditAppointment(a)} className=\"px-2 py-1 border rounded text-xs\">Edit</button>\r\n                      {a.status !== 'cancelled' ? <button onClick={() => handleCancelAppointment(a.id)} className=\"px-2 py-1 bg-red-600 text-white rounded text-xs\">Cancel</button> : <div className=\"text-xs text-slate-400\">Cancelled</div>}\r\n                    </div>\r\n                  </div>\r\n                ))}\r\n              </div>\r\n            </>\r\n          )}\r\n\r\n          {tab === 'create' && (\r\n            <>\r\n              <div className=\"text-sm text-slate-600\">{editingAppointment ? 'Edit appointment' : 'Create a new appointment'}</div>\r\n              <div className=\"mt-3\">\r\n                <NewAppointmentForm\r\n                  patientNic={form.nic || form.id}\r\n                  initialAppointment={editingAppointment}\r\n                  onSubmit={handleAppointmentFormSubmit}\r\n                  disabled={busy}\r\n                />\r\n                {editingAppointment && (\r\n                  <div className=\"mt-3 text-right\">\r\n                    <button onClick={() => { setEditingAppointment(null); setTab('active'); }} className=\"text-sm px-3 py-1 rounded-md border text-slate-700\">Stop editing</button>\r\n                  </div>\r\n                )}\r\n              </div>\r\n            </>\r\n          )}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 2076, "column": 0}, "map": {"version":3,"sources":["file:///D:/Education/WebDev%20with%20AI/Projects/clinic-suite/app/patients/page.js"],"sourcesContent":["// app/patients/page.js\n'use client';\n\nimport { useEffect, useState } from 'react';\nimport { useAuth } from '../../components/AuthProvider';\nimport {\n  subscribePatients,\n  createOrUpdatePatient,\n  subscribeAppointmentsForPatient,\n  createAppointment,\n  updateAppointment,\n  updatePatient,\n  cancelAppointment\n} from '../../lib/firestoreClient';\nimport PatientSidebar from '../../components/PatientSidebar';\nimport PatientDetailCard from '../../components/PatientDetailCard';\n\nexport default function PatientsPage() {\n  const { user, claims, loading } = useAuth();\n  const [patients, setPatients] = useState([]);\n  const [filtered, setFiltered] = useState([]);\n  const [q, setQ] = useState('');\n  const [selectedPatient, setSelectedPatient] = useState(null);\n  const [appointments, setAppointments] = useState([]);\n  const [busy, setBusy] = useState(false);\n  const [error, setError] = useState(null);\n\n  // --- AUTH GUARD UI (loading / sign-in) ---\n  if (loading) {\n    return (\n      <div className=\"min-h-[calc(100vh-56px)] flex items-center justify-center\">\n        <div className=\"text-sm text-slate-500\">Loading authentication...</div>\n      </div>\n    );\n  }\n\n  if (!user) {\n    return (\n      <div className=\"min-h-[calc(100vh-56px)] flex items-center justify-center\">\n        <div className=\"max-w-lg p-6 bg-white rounded-lg shadow\">\n          <h2 className=\"text-lg font-semibold\">Sign in required</h2>\n          <p className=\"mt-2 text-sm text-slate-600\">You must be signed in to access the Patients area.</p>\n          <div className=\"mt-4 text-right\">\n            <a href=\"/login\" className=\"px-3 py-2 bg-indigo-600 text-white rounded\">Go to login</a>\n          </div>\n        </div>\n      </div>\n    );\n  }\n  // ------------------------------------------------\n\n  // Subscribe patient list\n  useEffect(() => {\n    if (loading) return;\n    if (!claims?.clinicId) return;\n    setError(null);\n    const unsub = subscribePatients(claims.clinicId, (items) => setPatients(items), (err) => setError(err.message || String(err)));\n    return () => unsub();\n  }, [claims, loading]);\n\n  // client-side search\n  useEffect(() => {\n    const term = (q || '').trim().toLowerCase();\n    if (!term) setFiltered(patients);\n    else setFiltered(patients.filter((p) => {\n      const name = ((p.firstName || '') + ' ' + (p.lastName || '')).toLowerCase();\n      return name.includes(term) || (p.nic || '').toLowerCase().includes(term) || (p.phone || '').toLowerCase().includes(term);\n    }));\n  }, [q, patients]);\n\n  // subscribe appointments when a real patient (not new) is selected\n  useEffect(() => {\n    if (!selectedPatient || !claims?.clinicId || selectedPatient.isNew) {\n      setAppointments([]);\n      return;\n    }\n    const unsub = subscribeAppointmentsForPatient(claims.clinicId, selectedPatient.id, (items) => setAppointments(items), (err) => setError(err.message || String(err)));\n    return () => unsub();\n  }, [selectedPatient, claims]);\n\n  // Open create in center panel\n  function handleOpenCreate() {\n    const blank = {\n      id: '', // empty -> treated as new\n      nic: '',\n      firstName: '',\n      lastName: '',\n      dob: '',\n      gender: '',\n      phone: '',\n      address: '',\n      allergies: [],\n      isNew: true\n    };\n    setSelectedPatient(blank);\n  }\n\n  // Create patient (called from PatientDetailCard)\n  async function handleCreatePatient(payload) {\n    if (!claims?.clinicId) {\n      setError('No clinicId in your account.');\n      throw new Error('No clinicId');\n    }\n    setBusy(true);\n    try {\n      // payload must include nic\n      const created = await createOrUpdatePatient(claims.clinicId, payload, user?.email);\n      // created.id will be NIC\n      setSelectedPatient(created);\n      return created;\n    } catch (err) {\n      console.error(err);\n      setError(err.message || String(err));\n      throw err;\n    } finally {\n      setBusy(false);\n    }\n  }\n\n  // Update existing patient (called from PatientDetailCard)\n  async function handleUpdatePatient(patch) {\n    if (!claims?.clinicId || !selectedPatient) return;\n    if (selectedPatient.isNew) {\n      // shouldn't happen; creation flow above handles new\n      return;\n    }\n    setBusy(true);\n    try {\n      const updated = await updatePatient(claims.clinicId, selectedPatient.id, patch);\n      setSelectedPatient(updated);\n      return updated;\n    } catch (err) {\n      console.error(err);\n      setError(err.message || String(err));\n      throw err;\n    } finally {\n      setBusy(false);\n    }\n  }\n\n  async function handleCreateAppointment(apptData) {\n    if (!claims?.clinicId || !selectedPatient) return;\n    setBusy(true);\n    try {\n      await createAppointment(claims.clinicId, { patientNic: selectedPatient.id, ...apptData, receptionistEmail: user?.email });\n    } catch (err) {\n      console.error(err); setError(err.message || String(err));\n    } finally { setBusy(false); }\n  }\n\n  async function handleAppointmentAction(appointmentId, action, data = {}) {\n    if (!claims?.clinicId) return;\n    setBusy(true);\n    try {\n      if (action === 'update') {\n        await updateAppointment(claims.clinicId, appointmentId, data);\n      } else if (action === 'cancel') {\n        await cancelAppointment(claims.clinicId, appointmentId, user?.email);\n      }\n    } catch (err) {\n      console.error(err); setError(err.message || String(err));\n    } finally { setBusy(false); }\n  }\n\n  return (\n    <div className=\"min-h-[calc(100vh-56px)] bg-slate-50\">\n      <div className=\"max-w-7xl mx-auto px-4 py-8 grid grid-cols-1 lg:grid-cols-12 gap-6\">\n        {/* Sidebar */}\n        <aside className=\"lg:col-span-3\">\n          <PatientSidebar\n            patients={filtered}\n            query={q}\n            onQuery={setQ}\n            onSelect={setSelectedPatient}\n            selectedId={selectedPatient?.id}\n            onOpenCreate={handleOpenCreate}\n            disabled={busy}\n          />\n        </aside>\n\n        {/* Main */}\n        <main className=\"lg:col-span-6\">\n          {!selectedPatient ? (\n            <div className=\"rounded-xl bg-white shadow-sm p-8 text-center\">\n              <h2 className=\"text-2xl font-semibold text-slate-800\">Select a patient</h2>\n              <p className=\"mt-2 text-slate-500\">Search or create a patient on the left. Click a patient to view details.</p>\n            </div>\n          ) : (\n            <PatientDetailCard\n              patient={selectedPatient}\n              isNew={!!selectedPatient.isNew}\n              appointments={appointments}\n              onCreatePatient={handleCreatePatient}\n              onUpdatePatient={handleUpdatePatient}\n              onCreateAppointment={handleCreateAppointment}\n              onAppointmentAction={handleAppointmentAction}\n              busy={busy}\n              onCloseCreate={() => setSelectedPatient(null)}\n            />\n          )}\n        </main>\n\n        {/* Right quick actions */}\n        <aside className=\"lg:col-span-3\">\n          <div className=\"sticky top-6 space-y-4\">\n            <div className=\"rounded-xl bg-white shadow-sm p-4\">\n              <h3 className=\"text-sm text-slate-500\">Quick actions</h3>\n              <div className=\"mt-3 flex flex-col gap-2\">\n                <button onClick={() => { setSelectedPatient(null); setQ(''); }} className=\"text-sm px-3 py-2 rounded-md border border-slate-100 text-slate-700\">Clear selection</button>\n                <button onClick={() => window.location.reload()} className=\"text-sm px-3 py-2 rounded-md border border-slate-100 text-slate-700\">Refresh</button>\n              </div>\n            </div>\n          </div>\n        </aside>\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}}]
}