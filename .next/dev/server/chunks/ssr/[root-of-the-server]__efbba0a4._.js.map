{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 100, "column": 0}, "map": {"version":3,"sources":["file:///D:/Education/WebDev%20with%20AI/Projects/clinic-suite/lib/firebase.js"],"sourcesContent":["// lib/firebase.js (DEBUG VERSION)\n// Overwrite your existing file with this while debugging.\n// After debugging you may revert to the normal version (no window exposure).\n\nimport { initializeApp, getApps } from \"firebase/app\";\nimport { getAuth } from \"firebase/auth\";\nimport { getFirestore } from \"firebase/firestore\";\nimport { getStorage } from \"firebase/storage\";\n\nconst clientConfig = {\n  apiKey: process.env.NEXT_PUBLIC_FIREBASE_API_KEY || null,\n  authDomain: process.env.NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN || null,\n  projectId: process.env.NEXT_PUBLIC_FIREBASE_PROJECT_ID || null,\n  storageBucket: process.env.NEXT_PUBLIC_FIREBASE_STORAGE_BUCKET || null,\n  messagingSenderId: process.env.NEXT_PUBLIC_FIREBASE_MESSAGING_SENDER_ID || null,\n  appId: process.env.NEXT_PUBLIC_FIREBASE_APP_ID || null\n};\n\nlet firebaseApp;\nif (!getApps().length) {\n  try {\n    firebaseApp = initializeApp(clientConfig);\n    // eslint-disable-next-line no-empty\n  } catch (err) {\n    console.error('Firebase initializeApp error (likely invalid config):', err);\n    // still expose partial config for debugging\n    firebaseApp = null;\n  }\n} else {\n  firebaseApp = getApps()[0];\n}\n\nexport const auth = firebaseApp ? getAuth(firebaseApp) : null;\nexport const db = firebaseApp ? getFirestore(firebaseApp) : null;\nexport const storage = firebaseApp ? getStorage(firebaseApp) : null;\n\n// DEBUG: expose runtime info for browser console inspection\nif (typeof window !== 'undefined') {\n  window.__CLINIC_DEBUG__ = window.__CLINIC_DEBUG__ || {};\n  window.__CLINIC_DEBUG__.firebaseClientConfig = clientConfig;\n  window.__CLINIC_DEBUG__.firebaseApp = firebaseApp;\n  window.__CLINIC_DEBUG__.auth = auth;\n  window.__CLINIC_DEBUG__.db = db;\n  window.__CLINIC_DEBUG__.storage = storage;\n  console.debug('FIREBASE DEBUG: exported to window.__CLINIC_DEBUG__');\n  console.debug('FIREBASE CONFIG:', clientConfig);\n}\n"],"names":[],"mappings":"AAAA,kCAAkC;AAClC,0DAA0D;AAC1D,6EAA6E;;;;;;;;;AAE7E;AAAA;AACA;AAAA;AACA;AAAA;AACA;AAAA;;;;;AAEA,MAAM,eAAe;IACnB,QAAQ,+EAA4C;IACpD,YAAY,6EAAgD;IAC5D,WAAW,6DAA+C;IAC1D,eAAe,iFAAmD;IAClE,mBAAmB,oDAAwD;IAC3E,OAAO,iFAA2C;AACpD;AAEA,IAAI;AACJ,IAAI,CAAC,IAAA,8LAAO,IAAG,MAAM,EAAE;IACrB,IAAI;QACF,cAAc,IAAA,oMAAa,EAAC;IAC5B,oCAAoC;IACtC,EAAE,OAAO,KAAK;QACZ,QAAQ,KAAK,CAAC,yDAAyD;QACvE,4CAA4C;QAC5C,cAAc;IAChB;AACF,OAAO;IACL,cAAc,IAAA,8LAAO,GAAE,CAAC,EAAE;AAC5B;AAEO,MAAM,OAAO,cAAc,IAAA,4NAAO,EAAC,eAAe;AAClD,MAAM,KAAK,cAAc,IAAA,oMAAY,EAAC,eAAe;AACrD,MAAM,UAAU,cAAc,IAAA,qNAAU,EAAC,eAAe;AAE/D,4DAA4D;AAC5D"}},
    {"offset": {"line": 154, "column": 0}, "map": {"version":3,"sources":["file:///D:/Education/WebDev%20with%20AI/Projects/clinic-suite/components/AuthProvider.js"],"sourcesContent":["// components/AuthProvider.js\r\n'use client';\r\n\r\nimport React, { createContext, useContext, useEffect, useState } from 'react';\r\nimport { onAuthStateChanged, getIdTokenResult } from 'firebase/auth';\r\nimport { auth, db } from '../lib/firebase';\r\nimport { doc, getDoc } from 'firebase/firestore';\r\n\r\nconst AuthContext = createContext({ user: null, claims: null, loading: true });\r\n\r\nexport function AuthProvider({ children }) {\r\n  const [user, setUser] = useState(null);\r\n  const [claims, setClaims] = useState(null);\r\n  const [loading, setLoading] = useState(true);\r\n\r\n  useEffect(() => {\r\n    const unsub = onAuthStateChanged(auth, async (u) => {\r\n      if (!u) {\r\n        setUser(null);\r\n        setClaims(null);\r\n        setLoading(false);\r\n        return;\r\n      }\r\n      setUser(u);\r\n      setLoading(true);\r\n\r\n      let tokenClaims = null;\r\n      try {\r\n        const idTokenResult = await getIdTokenResult(u, /* forceRefresh= */ false);\r\n        tokenClaims = idTokenResult.claims || null;\r\n      } catch (err) {\r\n        console.error('getIdTokenResult failed', err);\r\n        tokenClaims = null;\r\n      }\r\n\r\n      // If no clinicId on token, try reading users/{uid} as fallback\r\n      if (!tokenClaims?.clinicId) {\r\n        try {\r\n          const uRef = doc(db, 'users', u.uid);\r\n          const snap = await getDoc(uRef);\r\n          if (snap.exists()) {\r\n            const d = snap.data();\r\n            tokenClaims = {\r\n              ...tokenClaims,\r\n              clinicId: tokenClaims?.clinicId ?? d.clinicId ?? null,\r\n              role: tokenClaims?.role ?? d.role ?? null\r\n            };\r\n            console.debug('AuthProvider: fallback claims from users/{uid}', d);\r\n          }\r\n        } catch (err) {\r\n          console.error('Failed to fetch users/{uid} fallback', err);\r\n        }\r\n      }\r\n\r\n      setClaims(tokenClaims);\r\n      setLoading(false);\r\n    });\r\n\r\n    return () => unsub();\r\n  }, []);\r\n\r\n  return (\r\n    <AuthContext.Provider value={{ user, claims, loading }}>\r\n      {children}\r\n    </AuthContext.Provider>\r\n  );\r\n}\r\n\r\nexport function useAuth() {\r\n  return useContext(AuthContext);\r\n}\r\n"],"names":[],"mappings":"AAAA,6BAA6B;;;;;;;;AAG7B;AACA;AAAA;AACA;AACA;AAAA;AALA;;;;;;AAOA,MAAM,4BAAc,IAAA,yOAAa,EAAC;IAAE,MAAM;IAAM,QAAQ;IAAM,SAAS;AAAK;AAErE,SAAS,aAAa,EAAE,QAAQ,EAAE;IACvC,MAAM,CAAC,MAAM,QAAQ,GAAG,IAAA,oOAAQ,EAAC;IACjC,MAAM,CAAC,QAAQ,UAAU,GAAG,IAAA,oOAAQ,EAAC;IACrC,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,oOAAQ,EAAC;IAEvC,IAAA,qOAAS,EAAC;QACR,MAAM,QAAQ,IAAA,uOAAkB,EAAC,0IAAI,EAAE,OAAO;YAC5C,IAAI,CAAC,GAAG;gBACN,QAAQ;gBACR,UAAU;gBACV,WAAW;gBACX;YACF;YACA,QAAQ;YACR,WAAW;YAEX,IAAI,cAAc;YAClB,IAAI;gBACF,MAAM,gBAAgB,MAAM,IAAA,qOAAgB,EAAC,GAAG,iBAAiB,GAAG;gBACpE,cAAc,cAAc,MAAM,IAAI;YACxC,EAAE,OAAO,KAAK;gBACZ,QAAQ,KAAK,CAAC,2BAA2B;gBACzC,cAAc;YAChB;YAEA,+DAA+D;YAC/D,IAAI,CAAC,aAAa,UAAU;gBAC1B,IAAI;oBACF,MAAM,OAAO,IAAA,2LAAG,EAAC,wIAAE,EAAE,SAAS,EAAE,GAAG;oBACnC,MAAM,OAAO,MAAM,IAAA,8LAAM,EAAC;oBAC1B,IAAI,KAAK,MAAM,IAAI;wBACjB,MAAM,IAAI,KAAK,IAAI;wBACnB,cAAc;4BACZ,GAAG,WAAW;4BACd,UAAU,aAAa,YAAY,EAAE,QAAQ,IAAI;4BACjD,MAAM,aAAa,QAAQ,EAAE,IAAI,IAAI;wBACvC;wBACA,QAAQ,KAAK,CAAC,kDAAkD;oBAClE;gBACF,EAAE,OAAO,KAAK;oBACZ,QAAQ,KAAK,CAAC,wCAAwC;gBACxD;YACF;YAEA,UAAU;YACV,WAAW;QACb;QAEA,OAAO,IAAM;IACf,GAAG,EAAE;IAEL,qBACE,iQAAC,YAAY,QAAQ;QAAC,OAAO;YAAE;YAAM;YAAQ;QAAQ;kBAClD;;;;;;AAGP;AAEO,SAAS;IACd,OAAO,IAAA,sOAAU,EAAC;AACpB"}},
    {"offset": {"line": 262, "column": 0}, "map": {"version":3,"sources":["file:///D:/Education/WebDev%20with%20AI/Projects/clinic-suite/components/Navbar.js"],"sourcesContent":["// components/NavBar.js\n'use client';\n\nimport { useState, useEffect } from 'react';\nimport Link from 'next/link';\nimport { usePathname, useRouter } from 'next/navigation';\nimport { useAuth } from './AuthProvider';\nimport { signOut } from 'firebase/auth';\nimport { auth } from '../lib/firebase';\n\n/**\n * Role-aware Navbar\n * Hides pages based on claims.role\n *\n * Roles mapping (customize as needed):\n *  - admin       => sees everything\n *  - doctor      => sees: Consultation + Patients (added)\n *  - receptionist=> sees: Patients\n *  - pharmacist  => sees: Pharmacy / Drugs\n *  - billing     => sees: Billing / Invoices\n *\n * Add/remove links in `linksForRole` below as your app expands.\n */\nexport default function NavBar() {\n  const { user, claims, loading } = useAuth();\n  const pathname = usePathname();\n  const router = useRouter();\n  const [open, setOpen] = useState(false);\n\n  // Controlled links by role\n  const linksForRole = (role) => {\n    // default minimal links accessible by anyone signed in\n    const base = [\n      { href: '/', label: 'Home', show: true },\n    ];\n\n    const roleLinks = {\n      admin: [\n        { href: '/patients', label: 'Patients' },\n        { href: '/consultation', label: 'Consultation' },\n        { href: '/pharmacy', label: 'Pharmacy' },\n        { href: '/billing', label: 'Billing' },\n        { href: '/admin', label: 'Admin' },\n      ],\n      // doctors now also see Patients in addition to Consultation\n      doctor: [\n        { href: '/patients', label: 'Patients' },\n        { href: '/consultation', label: 'Consultation' },\n      ],\n      receptionist: [\n        { href: '/patients', label: 'Patients' },\n      ],\n      pharmacist: [\n        { href: '/pharmacy', label: 'Pharmacy' },\n      ],\n      billing: [\n        { href: '/billing', label: 'Billing' },\n      ]\n    };\n\n    return base.concat(roleLinks[role] || []);\n  };\n\n  async function handleSignOut() {\n    try {\n      await signOut(auth);\n      router.push('/login');\n    } catch (err) {\n      console.error('Sign out failed', err);\n      alert('Sign out failed: ' + (err.message || err));\n    }\n  }\n\n  // compute links once we have a role (or fallback to base links)\n  const role = claims?.role ?? null;\n  const links = role ? linksForRole(role) : linksForRole(null);\n\n  // Simple keyboard-friendly close on route change\n  useEffect(() => {\n    setOpen(false);\n  }, [pathname]);\n\n  // formatted role string shown below email (small lowercase)\n  const displayedRole = role ? String(role).toLowerCase() : null;\n\n  return (\n    <nav className=\"bg-white border-b border-slate-200\">\n      <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8\">\n        <div className=\"flex justify-between h-14 items-center\">\n          <div className=\"flex items-center gap-4\">\n            <Link href=\"/\" className=\"flex items-center gap-3\">\n              <div className=\"w-8 h-8 rounded-md bg-indigo-600 flex items-center justify-center text-white font-bold\">CS</div>\n              <div className=\"hidden sm:block\">\n                <div className=\"text-sm font-semibold text-slate-800\">Clinic Suite</div>\n                <div className=\"text-xs text-slate-400\">EMR & Clinic Management</div>\n              </div>\n            </Link>\n          </div>\n\n          {/* Desktop links */}\n          <div className=\"hidden md:flex md:items-center md:space-x-4\">\n            {loading ? (\n              <div className=\"text-sm text-slate-400\">Loading...</div>\n            ) : (\n              <>\n                {links.map(link => (\n                  <NavLink key={link.href} href={link.href} active={pathname === link.href}>\n                    {link.label}\n                  </NavLink>\n                ))}\n                <div className=\"border-l border-slate-100 pl-3 ml-3\">\n                  {user ? (\n                    <div className=\"flex items-center gap-3\">\n                      <div className=\"flex flex-col\">\n                        <div className=\"text-sm text-slate-700\">{user.email}</div>\n                        {displayedRole && (\n                          <div className=\"text-xs text-slate-400 lowercase\">{displayedRole}</div>\n                        )}\n                      </div>\n                      <button onClick={handleSignOut} className=\"text-sm px-3 py-1 rounded-md border\">Sign out</button>\n                    </div>\n                  ) : (\n                    <Link href=\"/login\" className=\"text-sm px-3 py-1 rounded-md border\">Sign in</Link>\n                  )}\n                </div>\n              </>\n            )}\n          </div>\n\n          {/* Mobile menu button */}\n          <div className=\"md:hidden flex items-center\">\n            <button onClick={() => setOpen(o => !o)} className=\"p-2 rounded-md border\" aria-label=\"Toggle menu\">\n              <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"h-5 w-5 text-slate-600\" viewBox=\"0 0 20 20\" fill=\"currentColor\">\n                {open ? (\n                  <path fillRule=\"evenodd\" d=\"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z\" clipRule=\"evenodd\" />\n                ) : (\n                  <path fillRule=\"evenodd\" d=\"M3 5h14a1 1 0 100-2H3a1 1 0 100 2zm14 6H3a1 1 0 000 2h14a1 1 0 000-2zm0 6H3a1 1 0 000 2h14a1 1 0 000-2z\" clipRule=\"evenodd\" />\n                )}\n              </svg>\n            </button>\n          </div>\n        </div>\n      </div>\n\n      {/* Mobile drawer */}\n      {open && (\n        <div className=\"md:hidden bg-white border-t border-slate-100\">\n          <div className=\"px-4 py-3 space-y-2\">\n            {loading ? (\n              <div className=\"text-sm text-slate-400\">Loading...</div>\n            ) : (\n              <>\n                {links.map(link => (\n                  <div key={link.href}>\n                    <Link href={link.href} className={`block px-3 py-2 rounded ${pathname === link.href ? 'bg-slate-100 font-medium' : 'text-slate-700'}`}>\n                      {link.label}\n                    </Link>\n                  </div>\n                ))}\n\n                <div className=\"pt-2 border-t border-slate-100\">\n                  {user ? (\n                    <div className=\"flex items-center justify-between\">\n                      <div className=\"flex flex-col\">\n                        <div className=\"text-sm text-slate-700\">{user.email}</div>\n                        {displayedRole && (\n                          <div className=\"text-xs text-slate-400 lowercase\">{displayedRole}</div>\n                        )}\n                      </div>\n                      <button onClick={handleSignOut} className=\"text-sm px-3 py-1 rounded-md border\">Sign out</button>\n                    </div>\n                  ) : (\n                    <Link href=\"/login\" className=\"block text-sm px-3 py-2 rounded border\">Sign in</Link>\n                  )}\n                </div>\n              </>\n            )}\n          </div>\n        </div>\n      )}\n    </nav>\n  );\n}\n\n/* Small NavLink subcomponent */\nfunction NavLink({ href, children, active }) {\n  return (\n    <Link href={href} className={`px-3 py-2 rounded-md text-sm ${active ? 'bg-slate-100 font-medium' : 'text-slate-700 hover:bg-slate-50'}`}>\n      {children}\n    </Link>\n  );\n}\n"],"names":[],"mappings":"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"}}]
}